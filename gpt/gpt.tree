#!/bin/bash

TARGET_DIRECTORY="$1"
if [ -z "${TARGET_DIRECTORY}" ]
then
    TARGET_DIRECTORY="."
fi
if [ ! -d "${TARGET_DIRECTORY}" ]
then
    echo "ERROR: The target directory does not exist"
    exit 1
fi

echo ""
echo "# Directory tree: ${TARGET_DIRECTORY}"
echo ""
echo  '```'
find streamer_agent  -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g' | grep -v pyc | grep -v __init__ | grep -v node_modules
echo  '```'

FILES=$(find "$TARGET_DIRECTORY" -type f | grep -v __pycache__ | grep -v .pyc | grep -v __init__ | grep -v node_modules)

for FILE in $FILES
do
    echo ""
    echo ""
    echo "# File: ${FILE}"
    echo ""
    echo  '```'
    cat "$FILE"
    echo  '```'
done
